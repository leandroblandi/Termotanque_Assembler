MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 
                      00002 ;***************************************************************************
                      00003 ; Programa main.asm (PIC16F628A)                                                Fecha: 04-10-2022       
                      00004 ; Autor: Leandro N. Blandi                                                                              
                                            
                      00005 ; Este programa simula las temperaturas de agua de un termotanque, desde        
                      00006 ; 35°C hasta 75°C, generando 5 segundos de retardo después de cada limite       
                      00007 ; - Velocidad del Reloj: 4MHz           - Tipo de Reloj: Interno                                
                      00008 ; - Perro guardián: OFF                                                                                 
                                    
                      00009 ; - Protección de código: OFF                                                                           
                                    
                      00010 ;***************************************************************************
                      00011 
                      00012 
                      00013 ;***************************************************************************
                      00014 ; Zona de datos                                                                                         
                                            
                      00015 ;***************************************************************************
                      00016 
2007   3F01           00017                 __CONFIG 3F01
                      00018                 LIST            P=16F628A
                      00019                 INCLUDE <P16F628A.INC>
                      00001         LIST
                      00002 ; P16F628A.INC  Standard Header File, Version 1.10    Microchip Technology, Inc.
                      00265         LIST
                      00266 
                      00020                 ERRORLEVEL -302
                      00021 
                      00022 
                      00023 ;***************************************************************************
                      00024 ; Zona de codigos                                                                                       
                                                    
                      00025 ;***************************************************************************
                      00026 
  00000020            00027 TEMP_ACT EQU 0X20               ; Lo usaremos para decrementar
  00000021            00028 TEMP_MIN EQU 0X21               ; Lo usaremos como limite superior
  00000022            00029 TEMP_MAX EQU 0X22               ; Lo usaremos como limite inferior
                      00030 
  00000023            00031 CONTADOR1 EQU 0X23      ; Reservamos estas direcciones para los contadores
  00000024            00032 CONTADOR2 EQU 0X24      ; Nos serviran para contar tiempos por software
  00000025            00033 CONTADOR3 EQU 0X25
                      00034 
                      00035                 ORG 0X00
                      00036 
                      00037 
                      00038 ;**************************************************************************
                      00039 ; Subrutina principal                                                                                   
                                       
                      00040 ;**************************************************************************
                      00041                                 
0000   3000           00042 INICIO  MOVLW D'0'                      ; Cargamos en W el valor inicial de la temperatura actual
0001   00A0           00043                 MOVWF TEMP_ACT          ; Cargamos el valor de W en la temperatura actual
MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00044 
0002   3023           00045                 MOVLW D'35'                     ; Cargamos en W el valor de la temperatura minima
0003   00A1           00046                 MOVWF TEMP_MIN          ; Cargamos el valor de W en la temperatura minima
                      00047 
0004   3046           00048                 MOVLW D'70'                     ; Cargamos en W el valor de la temperatura maxima
0005   00A2           00049                 MOVWF TEMP_MAX          ; Cargamos el valor de W en la temperatura maxima
                      00050                 
0006   2???           00051                 CALL INCREMENTO_TEMP            ; Que el agua comience a calentarse hasta el maximo
0007   2???           00052                 CALL ENCENDER_LED_MAXIMO        ; Que se encienda el LED para avisar que ya esta calient
                            e
                      00053                 
0008   2???           00054                 CALL DELAY_1S                   ; Una vez que calienta el agua espera 5s
0009   2???           00055                 CALL DELAY_1S
000A   2???           00056                 CALL DELAY_1S
000B   2???           00057                 CALL DELAY_1S
000C   2???           00058                 CALL DELAY_1S
                      00059                 
000D   2???           00060                 CALL DECREMENTO_TEMP            ; Que el agua empiece a enfriarse
000E   2???           00061                 CALL ENCENDER_LED_MINIMO        ; Que se encienda el LED para avisar que se enfrio
                      00062                 
000F   2???           00063                 CALL DELAY_1S                   ; Una vez que se enfria el agua espera 5s
0010   2???           00064                 CALL DELAY_1S
0011   2???           00065                 CALL DELAY_1S
0012   2???           00066                 CALL DELAY_1S
0013   2???           00067                 CALL DELAY_1S
                      00068                 
0014   2???           00069                 GOTO INICIO                     ; Volvemos a inicio, logrando un bucle infinito
                      00070                         
                      00071 
                      00072 ;***************************************************************************
                      00073 ; Subrutina que incrementa registro TEMP_ACT                                                            
                                                                    *
                      00074 ;***************************************************************************
                      00075                 
0015                  00076 INCREMENTO_TEMP                         ; INCREMENTA DESDE 0 o TEMP_MIN hasta TEMP_MAX
0015   0AA0           00077                 INCF TEMP_ACT,F         ; Vamos subiendo la temperatura actual  
                      00078                 
0016   0820           00079                 MOVFW TEMP_ACT          ; Cargamos el registro W con el valor de TEMP_ACT
0017   0222           00080                 SUBWF TEMP_MAX,W                ; Realizamos la resta entre la temperatura maxima y la a
                            ctual
                      00081                 
0018   1D03           00082                 BTFSS STATUS,Z          ; Si la temperatura llego a su limite (se salta el GOTO)
                      00083         
0019   2???           00084                 GOTO INCREMENTO_TEMP    ; Si aun no llego que siga incrementando
                      00085                 
001A   1103           00086                 BCF STATUS,Z                    ; Limpiamos el bit Z del status para usarlo luego
                      00087                 
001B   0008           00088                 RETURN
                      00089 
                      00090 
                      00091 ;***************************************************************************
                      00092 ; Subrutina que decrementa registro TEMP_ACT                                                    
                      00093 ;***************************************************************************
MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00094 
001C                  00095 DECREMENTO_TEMP                         ; DECREMENTA DESDE TEMP_MAX hasta TEMP_MIN
                      00096 
001C   03A0           00097                 DECF TEMP_ACT,F ; Decrementamos la temperatura
001D   0821           00098                 MOVFW TEMP_MIN          ; Cargamos el regisro W con el valor de TEMP_ACT
001E   0220           00099                 SUBWF TEMP_ACT,W                ; Realizamos la resta entre la temperatura minima y la a
                            ctual
                      00100                 
001F   1D03           00101                 BTFSS STATUS,Z          ; Si la temperatura es la minima que deje de decrementar
                      00102                 
0020   2???           00103                 GOTO DECREMENTO_TEMP    ; Sino, que continue
                      00104                 
0021   0008           00105                 RETURN
                      00106 
                      00107                 
                      00108 ;**************************************************************************
                      00109 ; Subrutinas de retardo
                      00110 ;**************************************************************************
                      00111 
0022   30FA           00112 DELAY_1MS       MOVLW D'250'                            ; Cargamos el valor 250 en W    
0023   00A3           00113                         MOVWF CONTADOR1                 ; Cargamos el valor de W en el primer contador
                      00114 
0024   0000           00115 RETARDO_1       NOP
0025   0BA3           00116                         DECFSZ CONTADOR1,F              ; Decrementamos en 1 el primer contador
0026   2???           00117                         GOTO RETARDO_1                  ; Repetimos la accion hasta que sea 0
0027   0008           00118                         RETURN
                      00119 
                      00120 
0028   30FA           00121 DELAY_250MS     MOVLW D'250'                            ; Cargamos el valor 250 en W
0029   00A4           00122                         MOVWF CONTADOR2                 ; Cargamos el valor de W en el segundo contador
                      00123 
002A   2???           00124 RETARDO_2       CALL DELAY_1MS                  ; Esperamos 1 milisegundo por cada
002B   0BA4           00125                         DECFSZ CONTADOR2,F              ; decremento del segundo contador
002C   2???           00126                         GOTO RETARDO_2                  ; Repetimos la accion hasta que sea 0
002D   0008           00127                         RETURN
                      00128 
                      00129 
002E   3004           00130 DELAY_1S                MOVLW D'4'                              ; Cargamos el valor 4 en W
002F   00A5           00131                         MOVWF CONTADOR3                 ; Cargamos el valor de W en el tercer contador
                      00132 
0030   2???           00133 RETARDO_3       CALL DELAY_250MS                        ; Esperamos 250 milisegundos por cada
0031   0BA5           00134                         DECFSZ CONTADOR3,F              ; decremento del tercer contador (250ms x 4 = 10
                            00ms)
0032   2???           00135                         GOTO RETARDO_3                  ; Repetimos la accion hasta que sea 0
0033   0008           00136                         RETURN
                      00137 
                      00138 
                      00139 ;**************************************************************************
                      00140 ; Subrutinas para encender LEDS                                                                    
                      00141 ;**************************************************************************
                      00142                 
0034                  00143 ENCENDER_LED_MAXIMO
0034   1683           00144                 BSF STATUS,RP0  ; Cambiamos al banco 1 para poder gestionar TRISB       
MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0035   1086           00145                 BCF TRISB,1             ; Seteamos como salida el bit RB1
0036   1283           00146                 BCF STATUS,RP0  ; Volvemos al banco 0 para gestionar PORTB
0037   1486           00147                 BSF PORTB,1             ; Habilitamos el pin RB1, es decir, prendemos el LED
0038   2???           00148                 CALL DELAY_1S   ; Retardo de 1 segundo
0039   1086           00149                 BCF PORTB,1             ; Deshabilitamos el pin RB2
003A   0008           00150                 RETURN
                      00151 
                      00152 
003B                  00153 ENCENDER_LED_MINIMO
003B   1683           00154                 BSF STATUS,RP0  ; Cambiamos al banco 1 para poder gestionar TRISB
003C   1106           00155                 BCF TRISB,2             ; Seteamos como salida el bit RB2
003D   1283           00156                 BCF STATUS,RP0  ; Volvemos al banco 0 para gestionar PORTB
003E   1506           00157                 BSF PORTB,2             ; Habilitamos el pin RB2, es decir, prendemos el LED
003F   2???           00158                 CALL DELAY_1S   ; Retardo de 1 segundo
0040   1106           00159                 BCF PORTB,2             ; Deshabilitamos el pin RB2
0041   0008           00160                 RETURN
                      00161                 
3F01                  00162                 END
MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  5


SYMBOL TABLE
  LABEL                             VALUE 

ADEN                              00000003
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCPR1H                            00000016
CCPR1L                            00000015
CIS                               00000003
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000001F
CMIE                              00000006
CMIF                              00000006
CONTADOR1                         00000023
CONTADOR2                         00000024
CONTADOR3                         00000025
CREN                              00000004
CSRC                              00000007
DC                                00000001
DECREMENTO_TEMP                   0000001C
DELAY_1MS                         00000022
DELAY_1S                          0000002E
DELAY_250MS                       00000028
EEADR                             0000009B
EECON1                            0000009C
EECON2                            0000009D
EEDATA                            0000009A
EEIE                              00000007
EEIF                              00000007
ENCENDER_LED_MAXIMO               00000034
ENCENDER_LED_MINIMO               0000003B
F                                 00000001
FERR                              00000002
FSR                               00000004
GIE                               00000007
INCREMENTO_TEMP                   00000015
INDF                              00000000
INICIO                            00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  6


SYMBOL TABLE
  LABEL                             VALUE 

INTF                              00000001
IRP                               00000007
NOT_BO                            00000000
NOT_BOD                           00000000
NOT_BOR                           00000000
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_T1SYNC                        00000002
NOT_TO                            00000004
OERR                              00000001
OPTION_REG                        00000081
OSCF                              00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PIE1                              0000008C
PIR1                              0000000C
PORTA                             00000005
PORTB                             00000006
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
RBIE                              00000003
RBIF                              00000000
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RETARDO_1                         00000024
RETARDO_2                         0000002A
RETARDO_3                         00000030
RP0                               00000005
RP1                               00000006
RX9                               00000006
RX9D                              00000000
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
STATUS                            00000003
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1OSCEN                           00000003
MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  7


SYMBOL TABLE
  LABEL                             VALUE 

T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TEMP_ACT                          00000020
TEMP_MAX                          00000022
TEMP_MIN                          00000021
TMR0                              00000001
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISB                             00000086
TRMT                              00000001
TX9                               00000006
TX9D                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
VR0                               00000000
VR1                               00000001
VR2                               00000002
VR3                               00000003
VRCON                             0000009F
VREN                              00000007
VROE                              00000006
VRR                               00000005
W                                 00000000
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CP_OFF                           00003FFF
_CP_ON                            00001FFF
_DATA_CP_OFF                      00003FFF
_DATA_CP_ON                       00003EFF
_ER_OSC_CLKOUT                    00003FFF
MPASM  5.31                          MAIN.ASM   10-12-2022  13:23:20         PAGE  8


SYMBOL TABLE
  LABEL                             VALUE 

_ER_OSC_NOCLKOUT                  00003FFE
_EXTCLK_OSC                       00003FEF
_HS_OSC                           00003FEE
_INTOSC_OSC_CLKOUT                00003FFD
_INTOSC_OSC_NOCLKOUT              00003FFC
_INTRC_OSC_CLKOUT                 00003FFD
_INTRC_OSC_NOCLKOUT               00003FFC
_LP_OSC                           00003FEC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC_CLKOUT                    00003FFF
_RC_OSC_NOCLKOUT                  00003FFE
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FED
__16F628A                         00000001
__DEBUG                           1

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,     2 suppressed

